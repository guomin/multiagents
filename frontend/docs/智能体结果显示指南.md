# 智能体运行结果显示指南

## 概述

本系统通过多层架构展示智能体运行结果，包括实时工作流监控和最终结果展示。

## 数据流程

```
用户提交展览需求 → API调用 → Store状态更新 → 组件渲染显示
     ↓              ↓         ↓           ↓
ExhibitionForm → Backend → ExhibitionStore → AgentWorkflow/Results
```

## 核心组件

### 1. ExhibitionStore (状态管理)

**位置**: `src/stores/exhibition.ts`

**主要功能**:
- 管理展览需求数据
- 跟踪智能体执行状态
- 存储运行结果
- 提供计算属性（进度、完成数量等）

**关键状态**:
```typescript
{
  currentExhibition: ExhibitionRequirement,    // 当前展览需求
  currentWorkflow: ExhibitionState,           // 完整工作流状态
  agentStatuses: AgentStatus[],                // 各智能体状态
  isProcessing: boolean,                       // 是否正在处理
  progressPercentage: number                   // 总体进度百分比
}
```

### 2. AgentWorkflow (实时工作流监控)

**位置**: `src/views/AgentWorkflow.vue`

**功能特点**:
- 实时显示智能体执行状态
- 可视化工作流进度
- 执行日志记录
- 支持取消和重启操作

**使用方式**:
```javascript
// 启动工作流
const exhibitionStore = useExhibitionStore()
await exhibitionStore.runExhibition(requirements)

// 手动更新智能体状态
exhibitionStore.updateProgress('curator', 'running')
exhibitionStore.updateProgress('curator', 'completed')
```

### 3. Results (结果展示)

**位置**: `src/views/Results.vue`

**展示内容**:
- 项目概览（预算、面积、时间等）
- 概念策划方案
- 空间设计方案
- 视觉设计方案
- 互动技术方案
- 预算估算明细
- 智能体工作回顾

## 如何显示智能体运行结果

### 方式1: 完整工作流（推荐）

**步骤1**: 创建展览需求
```javascript
// 在 ExhibitionForm.vue 中
const submitForm = async (formData) => {
  const result = await exhibitionStore.runExhibition(formData)
  router.push('/workflow') // 跳转到工作流页面
}
```

**步骤2**: 实时监控（AgentWorkflow.vue）
- 自动显示各智能体执行状态
- 实时更新进度条
- 记录执行日志
- 完成后自动跳转到结果页

**步骤3**: 查看结果（Results.vue）
- 展示所有智能体的输出结果
- 提供数据可视化（图表）
- 支持导出功能

### 方式2: 直接显示结果

如果你已经有完整的工作流数据，可以直接显示：

```javascript
// 直接设置工作流状态
const completeWorkflow = {
  requirements: exhibitionData,
  conceptPlan: { /* 策划结果 */ },
  spatialLayout: { /* 空间设计结果 */ },
  visualDesign: { /* 视觉设计结果 */ },
  interactiveSolution: { /* 互动技术结果 */ },
  budgetEstimate: { /* 预算估算结果 */ },
  currentStep: "项目完成",
  messages: ["处理完成"]
}

exhibitionStore.completeProcessing(completeWorkflow)
router.push('/results')
```

## 智能体输出数据结构

### 1. 概念策划智能体
```typescript
{
  concept: string,           // 核心概念
  narrative: string,         // 叙事结构
  keyExhibits: string[],     // 重点展品
  visitorFlow: string        // 观众动线
}
```

### 2. 空间设计智能体
```typescript
{
  layout: string,                    // 布局方案
  visitorRoute: string[],            // 参观路线
  zones: Array<{                     // 功能区域
    name: string,
    area: number,
    function: string
  }>,
  accessibility: string             // 无障碍设计
}
```

### 3. 视觉设计智能体
```typescript
{
  colorScheme: string[],      // 色彩方案
  typography: string,         // 字体设计
  brandElements: string[],    // 品牌元素
  visualStyle: string         // 视觉风格
}
```

### 4. 互动技术智能体
```typescript
{
  technologies: string[],     // 使用技术
  interactives: Array<{       // 互动装置
    name: string,
    description: string,
    type: string,
    cost?: number
  }>,
  technicalRequirements: string // 技术要求
}
```

### 5. 预算控制智能体
```typescript
{
  breakdown: Array<{          // 预算明细
    category: string,
    amount: number,
    description: string
  }>,
  totalCost: number,          // 总成本
  recommendations: string[]   // 优化建议
}
```

## API接口

### 运行展览设计
```javascript
POST /api/exhibition/run
Content-Type: application/json

{
  "title": "展览标题",
  "theme": "展览主题",
  "targetAudience": "目标受众",
  "venueSpace": {
    "area": 800,
    "height": 4.5,
    "layout": "开放式布局"
  },
  "budget": {
    "total": 500000,
    "currency": "CNY"
  },
  "duration": {
    "startDate": "2025-06-01",
    "endDate": "2025-08-31"
  },
  "specialRequirements": ["特殊要求"]
}
```

### 响应格式
```javascript
{
  "requirements": { /* 原始需求 */ },
  "conceptPlan": { /* 概念策划结果 */ },
  "spatialLayout": { /* 空间设计结果 */ },
  "visualDesign": { /* 视觉设计结果 */ },
  "interactiveSolution": { /* 互动技术结果 */ },
  "budgetEstimate": { /* 预算估算结果 */ },
  "currentStep": "当前步骤",
  "messages": ["处理消息"],
  "agents": [ /* 智能体状态数组 */ ]
}
```

## 最佳实践

### 1. 数据验证
确保后端返回的数据符合TypeScript类型定义，使用Zod进行验证。

### 2. 错误处理
```javascript
try {
  const result = await exhibitionStore.runExhibition(requirements)
  // 处理成功结果
} catch (error) {
  // 显示错误信息
  ElMessage.error('处理失败，请重试')
}
```

### 3. 加载状态
使用`isProcessing`状态控制UI显示，提升用户体验。

### 4. 实时更新
考虑使用WebSocket或轮询机制实现真正的实时状态更新。

## 自定义显示

### 修改显示样式
1. 编辑`src/views/Results.vue`调整结果展示布局
2. 修改`src/views/AgentWorkflow.vue`调整工作流可视化
3. 在`src/main.css`中添加自定义样式

### 添加新的显示字段
1. 更新`src/types/exhibition.ts`中的类型定义
2. 修改相应组件的模板部分
3. 确保后端API返回新字段

## 故障排除

### 常见问题

1. **结果不显示**
   - 检查Store中的`currentWorkflow`是否有数据
   - 确认API调用是否成功
   - 验证数据结构是否正确

2. **状态不更新**
   - 检查`updateProgress`方法调用
   - 确认组件是否正确监听Store状态

3. **页面跳转失败**
   - 检查路由配置
   - 确认使用正确的`router.push`调用

### 调试技巧

1. **查看Store状态**
```javascript
// 在浏览器控制台中
import { useExhibitionStore } from '@/stores/exhibition'
const store = useExhibitionStore()
console.log(store.currentWorkflow)
```

2. **监控API调用**
   - 使用浏览器开发者工具的Network标签
   - 检查API响应数据和错误信息

3. **Vue DevTools**
   - 安装Vue DevTools浏览器扩展
   - 查看组件状态和Store数据